<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title></title>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="underscore.js" type="text/javascript"></script>
  <script src="backbone.js" type="text/javascript"></script>

  <script src="js/state_machine.js" type="text/javascript"></script>
  <script src="js/table_source.js" type="text/javascript"></script>
  <script src="js/google_docs.js" type="text/javascript"></script>
  <script src="js/csv.js" type="text/javascript"></script>

  <script src="GoogleSpreadsheetEspresso.js" type="text/javascript"></script>
  <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet" />
  <style>
</style>
</head>
<body>

  <div class="container">

    <div class="page-header">
      <div class="row">
        <div class="col-md-8">
          <h1>
            <i class="glyphicon glyphicon-cloud-download"></i>
            Tableau Table
            <small>Web Data Connector</small>
          </h1>
        </div>
        <div class="col-md-4">
          <div id="select-source-wrapper">
            <label for="select-source">Data from:</label>
            <select id="select-source" class="form-control input-sm"></select>
          </div>
        </div>
      </div>
    </div>


        <div class="step-panel active" id="docs-start">

          <!-- Google docs form -->
          <form id="form-google-docs" class="form-select-source" data-tableau-provider="googleDocs">
            <div class="row">
              <div class="col-md-8">

                <div class="form-group">
                  <label for="key">Key</label>
                  <input type="text" data-tableau-source="googleDocs" data-tableau-key="key" class="form-control" id="key" placeholder="Enter the spreadsheet key">
                  <p class="help-block">Use <code>default</code> to load the first spreadsheet, or type the name of the tab.</p>
                  <p class="help-block">Use this key to access sample spreadsheet: <code>0AonYZs4MzlZbdEIycWhwSnNBSTBTUDl3WWdDSE1VbHc</code></p>
                </div>
              </div>

              <div class="col-md-4">
                <div class="form-group">
                  <label for="tab">Tab</label>
                  <input type="text" data-tableau-source="googleDocs" data-tableau-key="tab" class="form-control" id="tab" value="default" placeholder="Name of the tab">
                  <p class="help-block">
                  Use <code>default</code> to load the first spreadsheet, or type
                  the name of the tab.
                  </p>
                  <p class="help-block">
                  Accepted values for sheet name: default, the sheet name as
                  string, numeric position (first sheet is 1)
                  </p>
                </div>

              </div>

            </div>
          </form>

          <!-- CSV form -->
          <form id="source" class="form-select-source hide" data-tableau-provider="csv">
            <div class="row">
              <div class="col-md-12">
                <div class="form-group">
                  <label for="url">Url</label>
                  <input type="text" data-tableau-source="csv" data-tableau-key="url" class="form-control" id="url" placeholder="Enter the spreadsheet key">
                  <p class="help-block">
                    Use this key to access sample spreadsheet:
                    <code>https://spreadsheets.google.com/feeds/list/0AonYZs4MzlZbdEIycWhwSnNBSTBTUDl3WWdDSE1VbHc/default/public/values?alt=json</code>
                  </p>
                </div>
              </div>
            </div>
          </form>

          <button type="submit" class="btn btn-primary btn-lg" data-state-to="loading">Preview Data</button>
        </div>

        <div class="step-panel hide" id="loading">
          <!-- Data preview -->
          <div class="row">
            <div class="col-md-10 col-md-offset-1">
              <h3>Loading...</h3>
              <div class="progress">
                <div class="progress-bar progress-bar-striped active main-ajax-progress-bar" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                  <span class="sr-only">In progress...</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="step-panel hide" id="data-preview">
          <!-- Data preview -->
          <div class="row" id="data-preview">
            <div class="col-md-10 col-md-offset-1">
              <a href="#" class="btn btn-default" id="preview-back" data-state-to="start">
                <i class=""></i>Back
              </a>
              <div class="pull-right">
                <a href="#" class="btn btn-primary" id="preview-import" data-state-to="import">
                  <i class=""></i>Import data
                </a>
              </div>
              <div class="preview" id="data-preview-table">
              </div>
            </div>
          </div>
        </div>

        <div class="step-panel hide" id="importing">
          <!-- Data preview -->
          <div class="row">
            <div class="col-md-10 col-md-offset-1">
              <h3>Importing data into Tableau...</h3>
              <div class="progress">
                <div class="progress-bar progress-bar-striped progress-bar-warn active main-ajax-progress-bar" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                  <span class="sr-only">In progress...</span>
                </div>
              </div>
            </div>
          </div>
        </div>

  </div>

  <script id="source-select-tpl"  type="text/template">
    <% _.each(providers, function(provider, key){ %>
      <option value="<%- key  %>"><%- provider.name %></option>
    <% }); %>
  </script>
  
  <script id="header-table-tpl"  type="text/template">
    <table class="table">
      <tr>
          <th>Original key</th>
          <th>Import?</th>
          <th>Tableau name</th>
          <th>Tableau type</th>
      </tr>
      <% _.each( cols, function(type,key) { %>
        <tr>
          <th class="align-right"><%- key %></th>
          <td>
            <input type="checkbox" id="do_import_<%= key %>" checked="checked" />
          </td>
          <td>
            <input type="text" class="form-control" id="import_name_<%= key %>" value="<%= key  %>" placeholder="Name">
          </td>
          <td>
            <select class="form-control" id="import_type_<%= key %>">
              <% _.each( ["string", "int", "float", "date"], function(a_type) { %>
                <option value="<%- a_type %>"
                  <% if (a_type === type) { %>selected="selected"<% } %>
                ><%- a_type %></option>
              <% }); %>
            </select>
          </td>
        </tr>
      <% }); %>
    </table>
  </script>

<!--<div class="title">-->
	<!--<img src="http://cdn.starschema.net/databoss/spreadsheet.png">-->

	<!--Google Spreadsheet Connector-->
<!--</div>-->

<!--<br/>-->
<!--<form id="inputForm" action="">-->
  <!--<label for="documentKey">Spreadsheet Key</label>-->
  <!--<input type="text" id="key" name="documentKey" value="0AonYZs4MzlZbdEIycWhwSnNBSTBTUDl3WWdDSE1VbHc" style="width: 400px;" />-->
  <!--<br/>-->
  <!--<label for="documentKey">Sheet name</label>-->
  <!--<input type="text" id="tab" name="sheetName" value="default" style="width: 200px;" />-->
  <!--<br/>-->
  <!--<input type="submit" value="Get spreadsheet" class="button">-->
  <!--<br/>-->
<!--</form>-->

<!--<p>Please copy paste the document key from the File -> Publish menu to Spreadsheet key. </p>-->
<!--<p>Accepted values for sheet name: default, the sheet name as string, numeric position (first sheet is 1)</p>-->

<!--<p>Click <a href="#">here</a> for additional help. </p>-->

<!--<p>Use this key to access sample spreadsheet: <code>0AonYZs4MzlZbdEIycWhwSnNBSTBTUDl3WWdDSE1VbHc</core></p>-->

<!--</body>-->
</html> 
